<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>平屋慢生活 - Coding也是生活的溫暖調味</title><meta name="author" content="Allen"><meta name="copyright" content="Allen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="平屋慢生活">
<meta property="og:url" content="https://allenlin000.github.io.git/page/4/">
<meta property="og:site_name" content="平屋慢生活">
<meta property="og:locale">
<meta property="og:image" content="https://i.imgur.com/q4xr50n.png">
<meta property="article:author" content="Allen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/q4xr50n.png"><link rel="shortcut icon" href="/img/kiwibird.png"><link rel="canonical" href="https://allenlin000.github.io.git/page/4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '平屋慢生活',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-10-26 17:58:33'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.imgur.com/q4xr50n.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://i.imgur.com/86eENHu.png')"><nav id="nav"><span id="blog-info"><a href="/" title="平屋慢生活"><span class="site-name">平屋慢生活</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">平屋慢生活</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/CHI-KEKE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:chilly37647@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2025/05/13/NEW-DependencyInjection-7/" title="Dependency Injection - 測試"><img class="post-bg" src="https://i.imgur.com/xAbpKgd.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Dependency Injection - 測試"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/05/13/NEW-DependencyInjection-7/" title="Dependency Injection - 測試">Dependency Injection - 測試</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-05-13T14:07:05.000Z" title="Created 2025-05-13 22:07:05">2025-05-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%A8%8B%E6%80%9D%E8%88%9E%E6%83%B3/">程思舞想</a></span></div><div class="content">測試to Feng，這篇介紹 Autofac 觀念的文章 https://blog.darkthread.net/blog/autofac-notes-1/ ，有舉了一個範例，在完全不修改主要程式的情況下抽換不同功能的元件。如果要做單元測試，這超級重要。
例如：某個依賴 WebApi 提供內容的函式，單元測試期間需模擬不同 WebAPI 傳回結果，此時可透過 DI 將 WebAPI 服務元抽換成假元件傳回特定值以驗證不同狀況下邏輯正確。範例：https://blog.darkthread.net/blog/aspnet-core-di-practice/
</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/05/02/NEW-High-Availibility-HA/" title="Untitled"><img class="post-bg" src="https://i.imgur.com/f2eWUWv.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Untitled"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/05/02/NEW-High-Availibility-HA/" title="Untitled">Untitled</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-05-02T01:17:07.478Z" title="Created 2025-05-02 09:17:07">2025-05-02</time></span></div><div class="content">HA（High Availability，高可用性）
HA 之前，先搞懂 Stateful vs Stateless✅ Stateless component 是什麼？像是：Application Server（AS）&#x2F; Nginx
特性是：不會保存任何「狀態」（state），也就是沒有 session、使用者資料、執行進度這些。
所以它可以橫向擴充（scale out）非常容易，想加幾台就加幾台，反正大家都是 stateless。
如何維持 HA（高可用）？
靠 heartbeat（心跳）機制判斷哪台死掉。
有問題就換台 server 接手即可。
✅ Stateful component 是什麼？像是：PostgreSQL &#x2F; Kafka &#x2F; RabbitMQ
這類會保存狀態資料，例如資料庫內的使用者資料、訊息佇列的訊息等。
所以要維持 HA，比起 stateless 難很多，因為 state 不能亂丟、不能亂同步。
 二、Redis 是什麼？Stateless 嗎？如果 Redis 只是做 caching（快取），就可以當作 stateless 看待（ ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/04/03/86-%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%88%B0%E5%8D%80%E8%A7%80%E5%BD%B1%E5%BF%83%E5%BE%97/" title="86 不存在的戰區 - 請為自己努力活過而感到驕傲"><img class="post-bg" src="https://i.imgur.com/NUblcQu.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="86 不存在的戰區 - 請為自己努力活過而感到驕傲"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/03/86-%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%88%B0%E5%8D%80%E8%A7%80%E5%BD%B1%E5%BF%83%E5%BE%97/" title="86 不存在的戰區 - 請為自己努力活過而感到驕傲">86 不存在的戰區 - 請為自己努力活過而感到驕傲</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-04-03T08:37:34.000Z" title="Created 2025-04-03 16:37:34">2025-04-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BD%9C%E5%93%81%E9%91%91%E8%B3%9E/">作品鑑賞</a></span></div><div class="content">
前言人在前進時，時常懷疑自我價值在挫折之中，容易陷入內心的拉扯與消耗彷彿眼前的陰影遮蔽了過往一路走來的堅持與努力曾經一步一腳印走過的路，如今竟變得模糊不清。
蕾娜曾對辛耶說過


&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;想要戰鬥到底、想要活到最後，現在才能在這裡
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;我想，你可以更為此感到驕傲



故事大綱故事以戰火連天的前線作為開場，硝煙瀰漫、砲火轟鳴，大火照亮了那群平均年齡不到 20 歲的年輕士兵臉龐。然而，真正令人不寒而慄的，並非戰場本身，而是那冰冷無情且毫無人性的聲音，他透過通訊設備，不斷以侮辱與命令鞭策著這群尚未成年便踏入戰場的孩子…
就在我們尚未從戰爭的殘酷中回神，鏡頭一轉，卻進入另外一個不同的世界 – 溫柔清晨的陽光灑落在潔白的床連與床鋪上，共和國的居民在柔軟的被窩中悠悠醒來，伴隨著古典音樂的樂聲享用早餐，一切顯得如此安詳、那麼的理所當然、前線與後方之間的鴻溝，在這一瞬間顯得如此殘酷而荒謬
這不正是現實的倒影嗎？一場冠冕堂皇之下，悄然 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/11/24/%E5%8F%96%E5%BE%97%E7%B3%BB%E7%B5%B1%E8%B3%87%E8%A8%8A/" title="取得系統資訊"><img class="post-bg" src="https://i.imgur.com/Zly1UDM.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="取得系統資訊"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/11/24/%E5%8F%96%E5%BE%97%E7%B3%BB%E7%B5%B1%E8%B3%87%E8%A8%8A/" title="取得系統資訊">取得系統資訊</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-11-24T03:24:09.000Z" title="Created 2024-11-24 11:24:09">2024-11-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Others/">Others</a></span></div><div class="content">Process.GetProcesses() 範圍並不限於應用程式本身，它會返回系統中所有正在執行的 Process 資訊，這包括其他應用程式、系統服務以及其他使用者的 Process，但具體可見的範圍可能受到權限的限制。
WorkingSet64 是 Process 的實際記憶體使用量（物理記憶體），數值為 bytes。
Lambda Expression 應用 - TotalMemory簡單來說就是在方法呼叫端傳入我們的條件 (像是傳入一個 Where 一樣)，來決定內部的計算邏輯範圍
這個實作情境是這樣，使用 Process.GetProcesses() 取得所有 Process，並且篩選 &gt; 20 MB 的 Process，最後計算前兩名的資訊
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354void Main()&#123;	DisplayMemory(memory =&gt; memory &gt; 20 * 1024  ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/22/APIKey-Protected/" title=".NET CORE 環境變數"><img class="post-bg" src="https://i.imgur.com/nQ2Epa9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt=".NET CORE 環境變數"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/22/APIKey-Protected/" title=".NET CORE 環境變數">.NET CORE 環境變數</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-22T02:24:34.000Z" title="Created 2024-09-22 10:24:34">2024-09-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Others/">Others</a></span></div><div class="content">將 APIKey 存進環境變數參考 : https://blog.darkthread.net/blog/secure-apikey-for-console-app/
1234567891011121314151617181920212223242526byte[] additionalEntropy = &#123; 9, 8, 7, 6, 5 &#125;;Func&lt;string, string&gt; GetSecureEnvVar = (varName) =&gt; &#123;    var val = Environment.GetEnvironmentVariable(varName, EnvironmentVariableTarget.User);    if (!string.IsNullOrEmpty(val))    &#123;        try        &#123;            val = Encoding.UTF8.GetString(                ProtectedData.Unprotect(Convert.F ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/01/%E6%9E%B6%E6%A7%8B%E5%9C%96-UML/" title="UML"><img class="post-bg" src="https://i.imgur.com/ptNmOOD.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UML"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/01/%E6%9E%B6%E6%A7%8B%E5%9C%96-UML/" title="UML">UML</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-01T03:39:05.000Z" title="Created 2024-09-01 11:39:05">2024-09-01</time></span></div><div class="content"></div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/08/27/aws-cloudfront/" title="CloudFront"><img class="post-bg" src="https://i.imgur.com/ayE9tp1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CloudFront"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/08/27/aws-cloudfront/" title="CloudFront">CloudFront</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-08-26T16:00:00.000Z" title="Created 2024-08-27 00:00:00">2024-08-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Others/">Others</a></span></div><div class="content">CloudFront 就是 AWS 在全球各地設置了許多 Server，稱為 edge locations，這些 Server 可能存了網站的副本內容（如圖片、影片、網頁…等）。當使用者訪問網站時，他們會從最近的邊緣位置獲取內容，台灣雖然不是 AZ (Availability Zones) 但也設有 edge location!


幾個重要的名詞解釋Origin：
所有的原始文件（如圖片、影片、網頁等）都存放在這裡可以是 Amazon S3 存儲桶、EC2 伺服器，或者是由多台 EC2 伺服器組成的負載均衡系統
Edge Server：
這些就像是分布在世界各地的小型倉庫它們儲存源站內容的副本當用戶請求內容時，如果 Edge Server 有該內容，就直接提供如果沒有，就會向 Origin 請求，然後儲存並提供給用戶
Distribution：
這是 CDN 服務的入口點。就像是一個智能導航系統。當用戶訪問網站時，這個系統會自動將他們引導到最近的 Edge Server
Web Distribution：
這是專門為網站設計的分發類型。處理常見的網站文件，如圖片、CSS、JavaSc ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/08/26/Stripe/" title="Stripe (串接 ApplyPay 所需要知道的事)"><img class="post-bg" src="https://i.imgur.com/QYGzWvo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Stripe (串接 ApplyPay 所需要知道的事)"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/08/26/Stripe/" title="Stripe (串接 ApplyPay 所需要知道的事)">Stripe (串接 ApplyPay 所需要知道的事)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-08-26T02:50:00.000Z" title="Created 2024-08-26 10:50:00">2024-08-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Others/">Others</a></span></div><div class="content">最近在串接 Stripe 的 ApplePay，花了一段時間理解 Stripe 的付款流程，這邊整理一下 ApplePay Server side 這邊要知道的一些事情備忘
名詞解釋Platform Account : 平台帳戶，底下可能會有多個子帳戶Connected Account : 底下的子帳戶，就是你管理的商戶們
Direct Charge : Platform Account 與 Connected Account 是以 Standard 模式關聯在一起，客戶付款時，錢會直接流向 Connected Account，通常若商店選擇這種方式表示他們有能力處理與 Stripe 談到較好費率的能力，不需要電商平台處理
Destination Charge : 
Direct charge 概念：
Direct chargen 所指的方面是在 Stripe Connect 平台中，最終用戶（客戶）直接與商家（關聯帳戶）進行交易的模式。

客戶感知：在這種模式下，客戶可能不知道有一個中間平台參與其中。他們認為自己是直接與商家交易。

收費歸屬：交易記錄會出現在商家的 Stripe 帳 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/08/24/CDN-2/" title="Content Delivery Network（CDN）"><img class="post-bg" src="https://github.com/CHI-KEKE/pics/blob/main/Cache/CacheSql.png?raw=true" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Content Delivery Network（CDN）"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/08/24/CDN-2/" title="Content Delivery Network（CDN）">Content Delivery Network（CDN）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-08-24T08:10:11.000Z" title="Created 2024-08-24 16:10:11">2024-08-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%90%BD%E8%91%89%E4%B8%8B%E7%9A%84%E5%AD%98%E6%AA%94/">落葉下的存檔</a></span></div><div class="content">在一個大熱天的午後，你走在勤美綠園道上，突然想吃點冰冰涼涼的甜點。你走了 3 分鐘，到附近的全家便利商店，打開冰櫃看到一盒寫著「東京限定布丁」的商品，決定嚐嚐這份來自職人之國的綿密滋味。
等等——為什麼我在台中，卻能在便利商店買到「東京限定」的布丁？
如果是從日本工廠直寄過來，理論上要等上好幾天、還可能被海關卡住。但今天我們能即時吃到，是因為：
🎉「全家便利商店」早就跟日本合作，把布丁大量送到全台分店的冷藏庫裡，你走路 3 分鐘就能買到！
🍮 用布丁理解 CDN：就近提供內容這就像是 CDN（內容傳遞網路） 的概念：
CDN 預先把內容（如圖片、影片、靜態網頁）複製到遍佈世界各地的節點，當使用者要存取網站時，就能從最近的節點取得資料，而不用跨越半個地球回到原始主機。
📦 布丁&#x3D;靜態資源🏪 全家分店&#x3D;CDN 節點🏭 日本原廠&#x3D;你的主機（origin server）


💡「用空間（💰）換時間」—— Trade Space for Time

我們犧牲了更多儲存空間（在世界各地備份），換來用戶就近取用、速度飛快。
👾 技術面看 CDN Cach ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/08/24/%E7%B5%90%E5%B8%B3%E7%B3%BB%E7%B5%B1/" title="Content Delivery Network（CDN）"><img class="post-bg" src="https://github.com/CHI-KEKE/pics/blob/main/Cache/CacheSql.png?raw=true" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Content Delivery Network（CDN）"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/08/24/%E7%B5%90%E5%B8%B3%E7%B3%BB%E7%B5%B1/" title="Content Delivery Network（CDN）">Content Delivery Network（CDN）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-08-24T08:10:11.000Z" title="Created 2024-08-24 16:10:11">2024-08-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%90%BD%E8%91%89%E4%B8%8B%E7%9A%84%E5%AD%98%E6%AA%94/">落葉下的存檔</a></span></div><div class="content">加入購物車限流器單位時間內，限制可以加入購物車的數量
兩層票匣（Token Bucket）+ 秒級時間窗可以把每個方塊視為「某個時間窗內允許的票（tokens）」：

By SkuId 的票匣：每個 SKU 每秒最多 100 次加入（圖的 100 只是示意）。同一秒內，第 101 個想加的，因為他拿不到票，就被「請稍後再試」。

By ShopId 的票匣：同一商店合計每秒最多 1000 次加入。即使很多 SKU 分散加，也不能超過商店總上限，避免把該商店的後端資源用光。

時間軸（1s、2s、3s、…、ns）：代表「固定秒級視窗」或「每秒補票」。每過一秒，票匣重新裝滿（或按速率補票），下一秒再算。


🌳 「要通過，得同時有 Sku 的票 + Shop 的票」。任一票用完就被擋
〈每家店獨立設定〉—配額可調、資源隔離Shop A、Shop B 各自一套配額

A 店的白&#x2F;藍&#x2F;黃（SKU）可以是每秒 100。
B 店的大小中 SKU 也各有每秒 100。

營運面可調。大店、熱門品給高一點；新店、長尾品給保守值。
把限流放在「加入購物車」前段，Fail-fast
 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.imgur.com/q4xr50n.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Allen</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/CHI-KEKE"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/CHI-KEKE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:chilly37647@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">世界上總會有一些溫暖的小角落</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/26/SQL-%E6%99%82%E9%96%932/" title="SQL - 時の雫"><img src="https://i.imgur.com/NfCnwwU.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL - 時の雫"/></a><div class="content"><a class="title" href="/2025/10/26/SQL-%E6%99%82%E9%96%932/" title="SQL - 時の雫">SQL - 時の雫</a><time datetime="2025-10-26T03:01:34.000Z" title="Created 2025-10-26 11:01:34">2025-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/25/Polly/" title="Polly - Retry"><img src="https://github.com/CHI-KEKE/pics/blob/main/System-Design/security.png?raw=true" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Polly - Retry"/></a><div class="content"><a class="title" href="/2025/10/25/Polly/" title="Polly - Retry">Polly - Retry</a><time datetime="2025-10-25T03:12:11.000Z" title="Created 2025-10-25 11:12:11">2025-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/25/XOR/" title="XOR"><img src="https://github.com/CHI-KEKE/pics/blob/main/%E6%80%9D%E7%B4%A2%E6%97%A5%E5%92%8C/Stamp.png?raw=true" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XOR"/></a><div class="content"><a class="title" href="/2025/10/25/XOR/" title="XOR">XOR</a><time datetime="2025-10-25T00:35:05.000Z" title="Created 2025-10-25 08:35:05">2025-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/06/SQL-Paging/" title="SQL - Store Procedure"><img src="https://i.imgur.com/NfCnwwU.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL - Store Procedure"/></a><div class="content"><a class="title" href="/2025/10/06/SQL-Paging/" title="SQL - Store Procedure">SQL - Store Procedure</a><time datetime="2025-10-06T14:52:05.000Z" title="Created 2025-10-06 22:52:05">2025-10-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/06/%E7%B5%B1%E8%A8%88/" title="SQL - Store Procedure"><img src="https://i.imgur.com/NfCnwwU.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL - Store Procedure"/></a><div class="content"><a class="title" href="/2025/10/06/%E7%B5%B1%E8%A8%88/" title="SQL - Store Procedure">SQL - Store Procedure</a><time datetime="2025-10-06T14:52:05.000Z" title="Created 2025-10-06 22:52:05">2025-10-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="View More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Config/"><span class="card-category-list-name">Config</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Others/"><span class="card-category-list-name">Others</span><span class="card-category-list-count">14</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/SQL-%E8%81%B7%E5%A0%B4%E6%AD%B7%E9%9A%AA%E8%A8%98/"><span class="card-category-list-name">SQL 職場歷險記</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WebAPI/"><span class="card-category-list-name">WebAPI</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BD%9C%E5%93%81%E9%91%91%E8%B3%9E/"><span class="card-category-list-name">作品鑑賞</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%85%AC%E5%8F%B8%E5%9C%A8%E6%90%9E%E4%BB%80%E5%95%A5/"><span class="card-category-list-name">公司在搞什啥</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%80%9D%E7%B4%A2%E6%97%A5%E5%92%8C/"><span class="card-category-list-name">思索日和</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9A%97%E5%8F%B7%E8%80%85%E3%81%AE%E7%A7%98%E5%AF%86%E3%81%AE%E9%83%A8%E5%B1%8B/"><span class="card-category-list-name">暗号者の秘密の部屋</span><span class="card-category-list-count">4</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/WebAPI/" style="font-size: 1.37em; color: #99a4b2">WebAPI</a> <a href="/tags/%E8%92%BC%E3%81%8D%E7%9B%BE/" style="font-size: 1.23em; color: #999ea6">蒼き盾</a> <a href="/tags/C/" style="font-size: 1.37em; color: #99a4b2">C#</a> <a href="/tags/Cache/" style="font-size: 1.23em; color: #999ea6">Cache</a> <a href="/tags/EF-CORE/" style="font-size: 1.23em; color: #999ea6">EF CORE</a> <a href="/tags/Newtonsoft-Json/" style="font-size: 1.1em; color: #999">Newtonsoft.Json</a> <a href="/tags/SQL-%E8%81%B7%E5%A0%B4%E6%AD%B7%E9%9A%AA%E8%A8%98/" style="font-size: 1.1em; color: #999">SQL 職場歷險記</a> <a href="/tags/%E6%80%9D%E7%B4%A2%E6%97%A5%E5%92%8C/" style="font-size: 1.1em; color: #999">思索日和</a> <a href="/tags/ThirdParty/" style="font-size: 1.1em; color: #999">ThirdParty</a> <a href="/tags/JSON/" style="font-size: 1.1em; color: #999">JSON</a> <a href="/tags/%E6%9E%B6%E6%A7%8B%E3%81%AE%E6%B5%B7%E3%81%AB%E7%81%AF%E3%82%8B%E6%98%9F/" style="font-size: 1.1em; color: #999">架構の海に灯る星</a> <a href="/tags/Encode/" style="font-size: 1.5em; color: #99a9bf">Encode</a> <a href="/tags/System-Text-Json/" style="font-size: 1.1em; color: #999">System.Text.Json</a> <a href="/tags/Validation/" style="font-size: 1.1em; color: #999">Validation</a> <a href="/tags/AWS/" style="font-size: 1.1em; color: #999">AWS</a> <a href="/tags/Memory/" style="font-size: 1.1em; color: #999">Memory</a> <a href="/tags/Serialization/" style="font-size: 1.1em; color: #999">Serialization</a> <a href="/tags/Dependency-Injection/" style="font-size: 1.23em; color: #999ea6">Dependency Injection</a> <a href="/tags/Tools/" style="font-size: 1.23em; color: #999ea6">Tools</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="View More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/10/"><span class="card-archive-list-date">October 2025</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">September 2025</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">August 2025</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">July 2025</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">May 2025</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">April 2025</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">November 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><span class="card-archive-list-count">2</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">52</div></div><div class="webinfo-item"><div class="item-name">Runtime :</div><div class="item-count" id="runtimeshow" data-publishDate="2024-03-01T10:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Last Update :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-10-26T09:58:33.076Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.imgur.com/yZlXwed.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Allen</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">What you'll find out there is boundless freedom !</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>